<app-navbar></app-navbar>
<div class="container">
  <div class="row">
    <div class="col-12 text-center">
      <h3 class="text-center">{{ mode === 'create' ? 'Adicionar Novo Usuário' : 'Editar Usuário' }}</h3>
    </div>

    <form [formGroup]="usuarioForm" (ngSubmit)="saveUsuario()">
      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label for="nome">Nome</label>
            <input type="text" id="nome" formControlName="nome" class="form-control">
            <div *ngIf="usuarioForm.controls['nome'].invalid && usuarioForm.controls['nome'].touched" class="text-danger">
              O nome é obrigatório.
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" formControlName="email" class="form-control" (keyup)="sugereUsername()">
            <div *ngIf="usuarioForm.controls['email'].invalid && usuarioForm.controls['email'].touched" class="text-danger">
              Por favor, insira um email válido.
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label for="username">Username</label>
            <input type="text" id="username" formControlName="username" class="form-control">
            <div *ngIf="usuarioForm.controls['username'].invalid && usuarioForm.controls['username'].touched" class="text-danger">
              O username é obrigatório.
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label for="ativo">Ativo</label>
            <input type="checkbox" id="ativo" formControlName="ativo">
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-6">
          <div class="form-group">
            <label for="password">Senha</label>
            <input type="password" class="form-control" id="password" formControlName="senha" placeholder="Digite uma nova senha">
            <div *ngIf="usuarioForm.controls['senha'].invalid && usuarioForm.controls['senha'].touched" class="text-danger">
              A senha é obrigatória.
            </div>
          </div>
        </div>

        <div class="col-6">
          <div class="form-group">
            <label for="confirmPassword">Confirmar Senha</label>
            <input type="password" class="form-control" id="confirmPassword" formControlName="confirmSenha" placeholder="Confirme a nova senha" (blur)="checkPasswordMatch()">
            <div *ngIf="senhaMismatch" class="text-danger">As senhas não coincidem</div>
            <div *ngIf="usuarioForm.controls['confirmSenha'].invalid && usuarioForm.controls['confirmSenha'].touched" class="text-danger">
              A senha é obrigatória.
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <button type="submit" class="btn btn-primary" [disabled]="usuarioForm.invalid">{{ mode === 'create' ? 'Adicionar' : 'Salvar' }}</button>
        </div>
      </div>
    </form>
  </div>
